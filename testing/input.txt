CREATE OR REPLACE PACKAGE BODY JOB_PKG AS
  PROCEDURE GET(PID IN INTEGER, PCURSOR OUT SYS_REFCURSOR)
  IS
  BEGIN
    OPEN PCURSOR FOR
      SELECT *
      FROM JOB
      WHERE ID=PID;
  END GET;
  
  PROCEDURE GET(PNAME IN JOB.NAME%TYPE, PCURSOR OUT SYS_REFCURSOR)
  IS
  BEGIN
    OPEN PCURSOR FOR
      SELECT *
      FROM JOB
      WHERE NAME=UPPER(PNAME);
  END GET;
  
  PROCEDURE GET(PCURSOR OUT SYS_REFCURSOR)
  IS
  BEGIN
    OPEN PCURSOR FOR
      SELECT *
      FROM JOB;
  END GET;
  
  PROCEDURE NEW(PJOB_TYPE IN JOB.JOB_TYPE%TYPE, PNAME IN JOB.NAME%TYPE, PDESC IN JOB.DESCRIPTION%TYPE, PID IN JOB.ID%TYPE DEFAULT SEQ_JOB_ID.NEXTVAL)
  IS
  BEGIN
    INSERT INTO JOB(ID, JOB_TYPE, NAME, DESCRIPTION)
    VALUES(PID,UPPER(PJOB_TYPE),UPPER(PNAME),PDESC);
    COMMIT;
    
    EXCEPTION
      WHEN OTHERS THEN
        ROLLBACK;
        RAISE;
  END NEW;
  
  PROCEDURE UPDATEJOB(PID IN JOB.ID%TYPE, PJOB_TYPE IN JOB.JOB_TYPE%TYPE, PNAME IN JOB.NAME%TYPE, PDESC IN JOB.DESCRIPTION%TYPE)
  IS
  BEGIN
    UPDATE JOB
    SET JOB_TYPE=UPPER(PJOB_TYPE)
      , NAME=UPPER(PNAME)
      , DESCRIPTION=UPPER(PDESC)
    WHERE ID=PID;
    COMMIT;
    
    EXCEPTION
      WHEN OTHERS THEN
        ROLLBACK;
        RAISE;
  END UPDATEJOB;
  
  PROCEDURE DELETE(PID IN JOB.ID%TYPE)
  IS
  BEGIN
    DELETE FROM JOB WHERE ID=PID;
    COMMIT;
    
    EXCEPTION
      WHEN OTHERS THEN
        ROLLBACK;
        RAISE;
  END DELETE;
END JOB_PKG;